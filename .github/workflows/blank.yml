name: My workflow

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      # Request manual approval
      - name: Request manual approval
        uses: github-script/script-action@v6
        script: |
          gh issue create --title "Request manual approval for deployment" --body "Please approve this deployment to the main branch." --assignees @approver1, @approver2

      # Wait for manual approval
      - name: Wait for manual approval
        uses: actions/github-script@v6
        if: ${{ github.event.inputs.approved }}
        script: |
          gh issue wait-for-review --issue-number ${{ github.event.issue.number }}

      - name: Deploy code
        run: make deploy

